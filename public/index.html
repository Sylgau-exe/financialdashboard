<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market & Economic Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #111827;
            --bg-card: #1a1f2e;
            --bg-card-hover: #232b3e;
            --border-color: #2d3748;
            --text-primary: #ffffff;
            --text-secondary: #e2e8f0;
            --text-muted: #cbd5e1;
            --green: #10b981;
            --green-dim: rgba(16, 185, 129, 0.15);
            --red: #ef4444;
            --red-dim: rgba(239, 68, 68, 0.15);
            --yellow: #f59e0b;
            --yellow-dim: rgba(245, 158, 11, 0.1);
            --blue: #60a5fa;
            --blue-dim: rgba(96, 165, 250, 0.15);
            --purple: #8b5cf6;
            --purple-dim: rgba(139, 92, 246, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        .header {
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--green);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .edit-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .edit-toggle:hover {
            border-color: var(--purple);
            color: var(--text-primary);
        }

        .edit-toggle.active {
            background: var(--purple-dim);
            border-color: var(--purple);
            color: var(--purple);
        }

        .notification-bell {
            position: relative;
            padding: 0.5rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.25rem;
        }

        .notification-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--red);
            color: white;
            font-size: 0.6rem;
            font-weight: 700;
            min-width: 16px;
            height: 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
        }

        .notification-badge.hidden { display: none; }

        .tabs-container {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 0 1.5rem;
        }

        .tabs {
            display: flex;
            gap: 0.25rem;
            max-width: 1600px;
            margin: 0 auto;
        }

        .tab {
            padding: 0.875rem 1.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            cursor: pointer;
            position: relative;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab:hover { color: var(--text-primary); }
        .tab.active { color: var(--text-primary); }
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--blue);
        }

        .tab-icon { font-size: 1rem; }

        .tab-badge {
            background: var(--yellow);
            color: #000;
            font-size: 0.6rem;
            padding: 0.1rem 0.4rem;
            border-radius: 4px;
            font-weight: 700;
        }

        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem;
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .section { margin-bottom: 1.5rem; }

        .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .section-bar {
            width: 3px;
            height: 14px;
            border-radius: 2px;
        }

        .section-header h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            color: var(--text-secondary);
        }

        .widget-row {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.5rem;
            overflow: hidden;
        }

        .key-watch-note {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 6px;
            padding: 0.5rem 0.75rem;
            margin-bottom: 0.5rem;
            font-size: 0.75rem;
            color: var(--yellow);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .econ-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.75rem;
        }

        .econ-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            transition: all 0.15s;
            position: relative;
        }

        .econ-card:hover { background: var(--bg-card-hover); }

        .econ-card.editable { cursor: pointer; }

        .econ-card.editable:hover {
            border-color: var(--purple);
            box-shadow: 0 0 0 1px var(--purple);
        }

        .econ-card.stale { border-color: var(--yellow); }

        .stale-badge {
            position: absolute;
            top: -8px;
            right: 10px;
            background: var(--yellow);
            color: #000;
            font-size: 0.55rem;
            font-weight: 700;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            text-transform: uppercase;
        }

        .econ-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .econ-card-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .econ-card-date {
            font-size: 0.6rem;
            color: var(--text-secondary);
            text-align: right;
        }

        .econ-card-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .econ-card-unit {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .econ-card-change {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .econ-card-change.up { background: var(--green-dim); color: var(--green); }
        .econ-card-change.down { background: var(--red-dim); color: var(--red); }
        .econ-card-change.neutral { background: var(--blue-dim); color: #93c5fd; }

        .interpretation {
            display: inline-block;
            font-size: 0.6rem;
            padding: 0.15rem 0.4rem;
            border-radius: 3px;
            margin-left: 0.5rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .interpretation.good { background: var(--green-dim); color: var(--green); }
        .interpretation.bad { background: var(--red-dim); color: var(--red); }
        .interpretation.watch { background: var(--yellow-dim); color: var(--yellow); }

        .econ-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border-color);
        }

        .econ-card-prev {
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .econ-card-source {
            font-size: 0.65rem;
            color: #93c5fd;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .econ-card-source:hover { text-decoration: underline; }

        .legend-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .legend-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .legend-box h3 {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
            padding-bottom: 0.3rem;
            border-bottom: 1px solid var(--border-color);
        }

        .legend-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            padding: 0.15rem 0;
        }

        .legend-label { color: var(--text-primary); }
        .legend-value { font-family: 'JetBrains Mono', monospace; font-weight: 600; }
        .legend-value.green { color: var(--green); }
        .legend-value.yellow { color: var(--yellow); }
        .legend-value.red { color: var(--red); }

        .info-box {
            background: var(--blue-dim);
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 6px;
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            font-size: 0.75rem;
            color: #93c5fd;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .info-box.edit-mode {
            background: var(--purple-dim);
            border-color: rgba(139, 92, 246, 0.3);
            color: #c4b5fd;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-overlay.active { display: flex; }

        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .modal-subtitle {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .modal-close:hover { color: var(--text-primary); }

        .source-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--purple-dim);
            border: 1px solid var(--purple);
            border-radius: 6px;
            color: var(--purple);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            font-weight: 600;
            text-decoration: none;
            margin-bottom: 1.5rem;
            transition: all 0.15s;
        }

        .source-button:hover { background: rgba(139, 92, 246, 0.25); }

        .form-group { margin-bottom: 1rem; }

        .form-label {
            display: block;
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-bottom: 0.4rem;
            font-family: 'JetBrains Mono', monospace;
            text-transform: uppercase;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--blue);
        }

        .form-input-small {
            font-size: 0.85rem;
            padding: 0.6rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-select {
            width: 100%;
            padding: 0.6rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }

        .form-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn {
            flex: 1;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
        }

        .btn-primary { background: var(--green); color: white; }
        .btn-primary:hover { background: #0ea472; }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-card-hover);
            color: var(--text-primary);
        }

        .notification-panel {
            position: fixed;
            top: 60px;
            right: 1rem;
            width: 380px;
            max-height: 80vh;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 500;
            overflow: hidden;
        }

        .notification-panel.active { display: block; }

        .notification-panel-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-card);
        }

        .notification-panel-content {
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.15s;
        }

        .notification-item:hover { background: var(--bg-card); }
        .notification-item:last-child { border-bottom: none; }

        .notification-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.25rem;
        }

        .notification-item-title {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .notification-item-region {
            font-size: 0.6rem;
            padding: 0.15rem 0.4rem;
            border-radius: 3px;
            background: var(--blue-dim);
            color: var(--blue);
        }

        .notification-item-detail {
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        .notification-item-date {
            font-size: 0.65rem;
            color: var(--yellow);
            margin-top: 0.35rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .no-notifications {
            padding: 2rem;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .no-notifications span {
            font-size: 2rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--green);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 2000;
        }

        .toast.show { transform: translateY(0); opacity: 1; }

        @media (max-width: 768px) {
            .tabs { overflow-x: auto; }
            .tab { white-space: nowrap; padding: 0.75rem 1rem; }
            .econ-grid { grid-template-columns: 1fr; }
            .notification-panel { width: 95%; right: 2.5%; }
            .header h1 { font-size: 0.9rem; }
            .header-controls { gap: 0.5rem; }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>
            <span class="status-dot"></span>
            MARKET & ECONOMIC DASHBOARD
        </h1>
        <div class="header-controls">
            <button class="notification-bell" onclick="toggleNotifications()" title="Pending Updates">
                üîî
                <span class="notification-badge" id="notificationBadge">0</span>
            </button>
            <button class="edit-toggle" id="editToggle" onclick="toggleEditMode()">
                ‚úèÔ∏è Edit Mode
            </button>
            <span style="font-size: 0.75rem; color: var(--text-secondary);">Sylvain's Command Center</span>
        </div>
    </header>

    <div class="notification-panel" id="notificationPanel">
        <div class="notification-panel-header">
            <span>üìã Pending Updates</span>
            <button onclick="toggleNotifications()" style="background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:1rem;">‚úï</button>
        </div>
        <div class="notification-panel-content" id="notificationList"></div>
    </div>

    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-header">
                <div>
                    <div class="modal-title" id="modalTitle">Edit Indicator</div>
                    <div class="modal-subtitle" id="modalSubtitle">Update with latest data</div>
                </div>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            
            <a href="#" class="source-button" id="modalSourceLink" target="_blank">
                üîó Open Official Source to Get Latest Data
            </a>
            
            <form id="editForm" onsubmit="saveEdit(event)">
                <input type="hidden" id="editId">
                
                <div class="form-group">
                    <label class="form-label">Value</label>
                    <input type="text" class="form-input" id="editValue" placeholder="e.g., 2.25">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Change Text</label>
                        <input type="text" class="form-input form-input-small" id="editChange" placeholder="e.g., ‚ñ≤ +0.1%">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Direction</label>
                        <select class="form-select" id="editDirection">
                            <option value="up">‚ñ≤ Up (Green)</option>
                            <option value="down">‚ñº Down (Red)</option>
                            <option value="neutral">‚Äî Neutral (Blue)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Period</label>
                        <input type="text" class="form-input form-input-small" id="editPeriod" placeholder="e.g., Jan 2026">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Previous</label>
                        <input type="text" class="form-input form-input-small" id="editPrevious" placeholder="e.g., Previous: 2.50%">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Next Release Date</label>
                        <input type="date" class="form-input form-input-small" id="editNextRelease">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Status Badge</label>
                        <select class="form-select" id="editInterpretation">
                            <option value="">None</option>
                            <option value="good">Good (Green)</option>
                            <option value="watch">Watch (Yellow)</option>
                            <option value="bad">Bad (Red)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">üíæ Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <div class="toast" id="toast">‚úì Saved successfully</div>

    <div class="tabs-container">
        <div class="tabs">
            <button class="tab active" onclick="switchTab('financial')">
                <span class="tab-icon">üìà</span>
                Financial Markets
            </button>
            <button class="tab" onclick="switchTab('us-economy')" id="tab-us">
                <span class="tab-icon">üá∫üá∏</span>
                US Economy
            </button>
            <button class="tab" onclick="switchTab('canada-economy')" id="tab-canada">
                <span class="tab-icon">üá®üá¶</span>
                Canada Economy
            </button>
            <button class="tab" onclick="switchTab('quebec-economy')" id="tab-quebec">
                <span class="tab-icon">‚öúÔ∏è</span>
                Quebec Economy
            </button>
        </div>
    </div>

    <main class="main-container">

        <div id="financial" class="tab-content active">
            <section class="section">
                <div class="section-header">
                    <div class="section-bar" style="background: var(--red);"></div>
                    <h2>Fear & Volatility</h2>
                </div>
                <div class="key-watch-note" style="background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); color: #f87171;">
                    üí° Bond ETFs move INVERSE to yields ‚Äî ETF ‚Üì means yields ‚Üë
                </div>
                <div class="widget-row">
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-tickers.js" async>
                        {"symbols":[{"description":"VIX","proName":"CAPITALCOM:VIX"},{"description":"TLT 20Y Bond","proName":"NASDAQ:TLT"},{"description":"IEF 10Y Bond","proName":"NASDAQ:IEF"},{"description":"SHY 1-3Y Bond","proName":"NASDAQ:SHY"}],"isTransparent":true,"showSymbolLogo":false,"colorTheme":"dark","locale":"en"}
                        </script>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <div class="section-bar" style="background: var(--purple);"></div>
                    <h2>Currencies & Dollar</h2>
                </div>
                <div class="key-watch-note">‚ö†Ô∏è USD/JPY is your key carry trade indicator ‚Äî watch for moves below 150</div>
                <div class="widget-row">
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-tickers.js" async>
                        {"symbols":[{"description":"DXY Index","proName":"CAPITALCOM:DXY"},{"description":"USD/JPY ‚ö†Ô∏è","proName":"FX:USDJPY"},{"description":"EUR/USD","proName":"FX:EURUSD"},{"description":"USD/CAD","proName":"FX:USDCAD"}],"isTransparent":true,"showSymbolLogo":false,"colorTheme":"dark","locale":"en"}
                        </script>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <div class="section-bar" style="background: var(--yellow);"></div>
                    <h2>Safe Havens</h2>
                </div>
                <div class="widget-row">
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-tickers.js" async>
                        {"symbols":[{"description":"Gold","proName":"TVC:GOLD"},{"description":"Silver","proName":"TVC:SILVER"},{"description":"Bitcoin","proName":"BITSTAMP:BTCUSD"},{"description":"Crude Oil","proName":"TVC:USOIL"}],"isTransparent":true,"showSymbolLogo":false,"colorTheme":"dark","locale":"en"}
                        </script>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <div class="section-bar" style="background: var(--green);"></div>
                    <h2>Equity Markets</h2>
                </div>
                <div class="widget-row">
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-tickers.js" async>
                        {"symbols":[{"description":"S&P 500","proName":"FOREXCOM:SPXUSD"},{"description":"Dow Jones","proName":"CAPITALCOM:US30"},{"description":"NASDAQ 100","proName":"CAPITALCOM:US100"},{"description":"TSX Canada","proName":"TSX:TSX"}],"isTransparent":true,"showSymbolLogo":false,"colorTheme":"dark","locale":"en"}
                        </script>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <div class="section-bar" style="background: var(--blue);"></div>
                    <h2>Banks ‚Äî Canary in Coal Mine</h2>
                </div>
                <div class="widget-row">
                    <div class="tradingview-widget-container">
                        <div class="tradingview-widget-container__widget"></div>
                        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-tickers.js" async>
                        {"symbols":[{"description":"JPMorgan","proName":"NYSE:JPM"},{"description":"BofA","proName":"NYSE:BAC"},{"description":"MUFG","proName":"NYSE:MUFG"},{"description":"Regionals","proName":"AMEX:KRE"}],"isTransparent":true,"showSymbolLogo":false,"colorTheme":"dark","locale":"en"}
                        </script>
                    </div>
                </div>
            </section>

            <div class="legend-section">
                <div class="legend-title">üìñ Quick Reference Guide</div>
                <div class="legend-grid">
                    <div class="legend-box">
                        <h3>Bond ETFs (inverse to yields)</h3>
                        <div class="legend-item"><span class="legend-label">TLT ‚Üì sharply</span><span class="legend-value red">30Y yields spiking</span></div>
                        <div class="legend-item"><span class="legend-label">All 3 ‚Üì together</span><span class="legend-value red">Bond selloff</span></div>
                        <div class="legend-item"><span class="legend-label">All 3 ‚Üë together</span><span class="legend-value green">Flight to safety</span></div>
                    </div>
                    <div class="legend-box">
                        <h3>USD/JPY (Carry Trade)</h3>
                        <div class="legend-item"><span class="legend-label">Yen Weak</span><span class="legend-value green">158+</span></div>
                        <div class="legend-item"><span class="legend-label">Watch Zone</span><span class="legend-value yellow">150-158</span></div>
                        <div class="legend-item"><span class="legend-label">Unwind/Crisis</span><span class="legend-value red">&lt;150</span></div>
                    </div>
                    <div class="legend-box">
                        <h3>DXY Dollar Index</h3>
                        <div class="legend-item"><span class="legend-label">Strong $</span><span class="legend-value green">105+</span></div>
                        <div class="legend-item"><span class="legend-label">Normal</span><span class="legend-value yellow">100-105</span></div>
                        <div class="legend-item"><span class="legend-label">Weak</span><span class="legend-value red">&lt;100</span></div>
                    </div>
                    <div class="legend-box">
                        <h3>Warning Patterns</h3>
                        <div class="legend-item"><span class="legend-label">"Sell America"</span><span class="legend-value red">DXY‚Üì TLT‚Üì Gold‚Üë</span></div>
                        <div class="legend-item"><span class="legend-label">Risk Off</span><span class="legend-value yellow">VIX‚Üë Stocks‚Üì</span></div>
                        <div class="legend-item"><span class="legend-label">Carry Unwind</span><span class="legend-value red">JPY‚Üë Banks‚Üì</span></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="us-economy" class="tab-content">
            <div class="info-box" id="us-info-box">‚ÑπÔ∏è Click üîî to see pending updates, or enable ‚úèÔ∏è Edit Mode to update values.</div>
            <div id="us-indicators"></div>
        </div>

        <div id="canada-economy" class="tab-content">
            <div class="info-box" id="canada-info-box">‚ÑπÔ∏è Click üîî to see pending updates, or enable ‚úèÔ∏è Edit Mode to update values.</div>
            <div id="canada-indicators"></div>
        </div>

        <div id="quebec-economy" class="tab-content">
            <div class="info-box" id="quebec-info-box">‚ÑπÔ∏è Click üîî to see pending updates, or enable ‚úèÔ∏è Edit Mode to update values.</div>
            <div id="quebec-indicators"></div>
        </div>

    </main>

    <script>
        const defaultData = {
            'us-cpi': { title: 'CPI (Consumer Price Index)', value: '2.9', unit: '% YoY', change: '‚ñ≤ +0.2% from Nov', direction: 'up', period: 'Dec 2025', releaseInfo: 'Released Jan 15', previous: 'Previous: 2.7%', interpretation: 'watch', interpretationText: 'Above target', source: 'https://www.bls.gov/cpi/', sourceText: 'BLS', nextRelease: '2026-02-12', category: 'us', section: 'Inflation' },
            'us-core-cpi': { title: 'Core CPI (ex Food & Energy)', value: '3.2', unit: '% YoY', change: '‚Äî Unchanged', direction: 'neutral', period: 'Dec 2025', releaseInfo: 'Released Jan 15', previous: 'Previous: 3.3%', interpretation: 'bad', interpretationText: 'Sticky', source: 'https://fred.stlouisfed.org/series/CPILFESL', sourceText: 'FRED', nextRelease: '2026-02-12', category: 'us', section: 'Inflation' },
            'us-pce': { title: 'PCE Price Index', value: '2.4', unit: '% YoY', change: '‚ñ≤ +0.1%', direction: 'up', period: 'Nov 2025', releaseInfo: 'Released Dec 20', previous: 'Previous: 2.3%', interpretation: 'watch', interpretationText: "Fed's preferred", source: 'https://fred.stlouisfed.org/series/PCEPI', sourceText: 'FRED', nextRelease: '2026-01-31', category: 'us', section: 'Inflation' },
            'us-unemployment': { title: 'Unemployment Rate', value: '4.1', unit: '%', change: '‚ñº -0.1%', direction: 'down', period: 'Dec 2025', releaseInfo: 'Released Jan 10', previous: 'Previous: 4.2%', interpretation: 'good', interpretationText: 'Healthy', source: 'https://fred.stlouisfed.org/series/UNRATE', sourceText: 'FRED', nextRelease: '2026-02-07', category: 'us', section: 'Employment' },
            'us-nfp': { title: 'Non-Farm Payrolls', value: '+256', unit: 'K jobs', change: '‚ñ≤ Beat expectations', direction: 'up', period: 'Dec 2025', releaseInfo: 'Released Jan 10', previous: 'Expected: +165K', interpretation: 'good', interpretationText: 'Strong', source: 'https://www.bls.gov/news.release/empsit.nr0.htm', sourceText: 'BLS', nextRelease: '2026-02-07', category: 'us', section: 'Employment' },
            'us-jobless': { title: 'Initial Jobless Claims', value: '223', unit: 'K', change: '‚ñ≤ +6K', direction: 'up', period: 'Week Jan 18', releaseInfo: 'Released Jan 23', previous: 'Previous: 217K', interpretation: 'good', interpretationText: 'Low', source: 'https://fred.stlouisfed.org/series/ICSA', sourceText: 'FRED', nextRelease: '2026-01-30', category: 'us', section: 'Employment' },
            'us-gdp': { title: 'GDP Growth', value: '3.1', unit: '% QoQ', change: '‚ñ≤ Revised up', direction: 'up', period: 'Q3 2025', releaseInfo: 'Final Estimate', previous: 'Previous: 2.8%', interpretation: 'good', interpretationText: 'Strong', source: 'https://www.bea.gov/data/gdp/gross-domestic-product', sourceText: 'BEA', nextRelease: '2026-01-30', category: 'us', section: 'Growth' },
            'us-fed-rate': { title: 'Fed Funds Rate', value: '4.25-4.50', unit: '%', change: '‚Äî Held steady', direction: 'neutral', period: 'Current', releaseInfo: 'Target Range', previous: 'Last cut: Dec 2025', interpretation: '', interpretationText: '', source: 'https://www.federalreserve.gov/monetarypolicy/openmarket.htm', sourceText: 'Fed', nextRelease: '2026-01-29', category: 'us', section: 'Federal Reserve' },
            'ca-cpi': { title: 'CPI (All Items)', value: '1.8', unit: '% YoY', change: '‚ñº -0.1%', direction: 'down', period: 'Dec 2025', releaseInfo: 'Released Jan 21', previous: 'Previous: 1.9%', interpretation: 'good', interpretationText: 'At target', source: 'https://www.statcan.gc.ca/en/subjects-start/prices_and_price_indexes/consumer_price_indexes', sourceText: 'StatsCan', nextRelease: '2026-02-18', category: 'canada', section: 'Inflation' },
            'ca-core-cpi': { title: 'Core CPI (Trim)', value: '2.5', unit: '% YoY', change: '‚ñº -0.2%', direction: 'down', period: 'Dec 2025', releaseInfo: 'Released Jan 21', previous: 'Previous: 2.7%', interpretation: '', interpretationText: '', source: 'https://www.bankofcanada.ca/rates/indicators/key-variables/', sourceText: 'BoC', nextRelease: '2026-02-18', category: 'canada', section: 'Inflation' },
            'ca-unemployment': { title: 'Unemployment Rate', value: '6.7', unit: '%', change: '‚ñº -0.1%', direction: 'down', period: 'Dec 2025', releaseInfo: 'Released Jan 10', previous: 'Previous: 6.8%', interpretation: 'watch', interpretationText: 'Elevated', source: 'https://www.statcan.gc.ca/en/subjects-start/labour_/labour-force-survey', sourceText: 'StatsCan', nextRelease: '2026-02-07', category: 'canada', section: 'Employment' },
            'ca-employment': { title: 'Employment Change', value: '+91', unit: 'K jobs', change: '‚ñ≤ Beat expectations', direction: 'up', period: 'Dec 2025', releaseInfo: 'Released Jan 10', previous: 'Expected: +25K', interpretation: 'good', interpretationText: 'Strong', source: 'https://www.statcan.gc.ca/en/subjects-start/labour_/labour-force-survey', sourceText: 'StatsCan', nextRelease: '2026-02-07', category: 'canada', section: 'Employment' },
            'ca-gdp': { title: 'GDP Growth', value: '+1.0', unit: '% QoQ ann.', change: '‚ñº Slowing', direction: 'down', period: 'Q3 2025', releaseInfo: 'Released Nov 29', previous: 'Previous: +2.1%', interpretation: '', interpretationText: '', source: 'https://www.statcan.gc.ca/en/subjects-start/economic_accounts', sourceText: 'StatsCan', nextRelease: '2026-02-28', category: 'canada', section: 'Growth' },
            'ca-home-price': { title: 'Home Price Index', value: '-2.5', unit: '% YoY', change: '‚ñº -0.3% MoM', direction: 'down', period: 'Nov 2025', releaseInfo: 'Teranet Index', previous: 'Previous: -2.2%', interpretation: 'watch', interpretationText: 'Declining', source: 'https://housepriceindex.ca/', sourceText: 'Teranet', nextRelease: '2026-02-15', category: 'canada', section: 'Housing' },
            'ca-boc-rate': { title: 'BoC Policy Rate', value: '2.25', unit: '%', change: '‚Äî Held Jan 28', direction: 'neutral', period: 'Current', releaseInfo: 'Target Rate', previous: 'Cycle: 4.25% ‚Üí 2.25%', interpretation: '', interpretationText: '', source: 'https://www.bankofcanada.ca/core-functions/monetary-policy/key-interest-rate/', sourceText: 'BoC', nextRelease: '2026-03-12', category: 'canada', section: 'Bank of Canada' },
            'qc-unemployment': { title: 'Unemployment Rate QC', value: '5.4', unit: '%', change: '‚ñ≤ +0.2%', direction: 'up', period: 'Dec 2025', releaseInfo: 'Released Jan 10', previous: 'Canada: 6.7%', interpretation: 'good', interpretationText: 'Below avg', source: 'https://statistique.quebec.ca/en/document/labour-force-survey', sourceText: 'ISQ', nextRelease: '2026-02-07', category: 'quebec', section: 'Employment' },
            'qc-employment': { title: 'Employment Change QC', value: '+23', unit: 'K jobs', change: '‚ñ≤ Strong month', direction: 'up', period: 'Dec 2025', releaseInfo: 'Released Jan 10', previous: 'Previous: -5K', interpretation: '', interpretationText: '', source: 'https://statistique.quebec.ca/en/document/labour-force-survey', sourceText: 'ISQ', nextRelease: '2026-02-07', category: 'quebec', section: 'Employment' },
            'qc-cpi': { title: 'CPI Quebec', value: '1.7', unit: '% YoY', change: '‚ñº -0.1%', direction: 'down', period: 'Dec 2025', releaseInfo: '', previous: 'Canada: 1.8%', interpretation: 'good', interpretationText: 'Below Canada', source: 'https://www.statcan.gc.ca/en/subjects-start/prices_and_price_indexes/consumer_price_indexes', sourceText: 'StatsCan', nextRelease: '2026-02-18', category: 'quebec', section: 'Inflation' },
            'qc-montreal-home': { title: 'Montreal Home Prices', value: '+2.1', unit: '% YoY', change: '‚ñ≤ +0.2% MoM', direction: 'up', period: 'Nov 2025', releaseInfo: 'Teranet Index', previous: 'Canada: -2.5%', interpretation: 'good', interpretationText: 'Stable', source: 'https://housepriceindex.ca/', sourceText: 'Teranet', nextRelease: '2026-02-15', category: 'quebec', section: 'Housing' },
            'qc-rent': { title: 'Rent Index Montreal', value: '+5.8', unit: '% YoY', change: '‚ñ≤ Still rising', direction: 'up', period: 'Dec 2025', releaseInfo: '', previous: 'Previous: +5.5%', interpretation: 'bad', interpretationText: 'High', source: 'https://www.statcan.gc.ca/en/subjects-start/prices_and_price_indexes/consumer_price_indexes', sourceText: 'StatsCan', nextRelease: '2026-02-18', category: 'quebec', section: 'Housing' },
            'qc-gdp': { title: 'Quebec GDP Growth', value: '+0.8', unit: '% QoQ ann.', change: '‚ñº Slowing', direction: 'down', period: 'Q3 2025', releaseInfo: '', previous: 'Canada: +1.0%', interpretation: '', interpretationText: '', source: 'https://statistique.quebec.ca/en/document/real-gross-domestic-product', sourceText: 'ISQ', nextRelease: '2026-02-28', category: 'quebec', section: 'Growth' }
        };

        let indicatorData = JSON.parse(localStorage.getItem('dashboardIndicators')) || JSON.parse(JSON.stringify(defaultData));
        let editMode = false;

        function renderCard(id, data) {
            const isStale = checkIfStale(data.nextRelease);
            const editableClass = editMode ? 'editable' : '';
            const staleClass = isStale ? 'stale' : '';
            const onclick = editMode ? `onclick="openEditModal('${id}')"` : '';
            let interpretationHtml = data.interpretation && data.interpretationText ? `<span class="interpretation ${data.interpretation}">${data.interpretationText}</span>` : '';
            let staleBadge = isStale ? '<div class="stale-badge">‚ö†Ô∏è Update Due</div>' : '';
            
            return `<div class="econ-card ${editableClass} ${staleClass}" ${onclick}>${staleBadge}<div class="econ-card-header"><span class="econ-card-title">${data.title}</span><span class="econ-card-date">${data.period}<br>${data.releaseInfo}</span></div><div class="econ-card-value">${data.value}<span class="econ-card-unit">${data.unit}</span>${interpretationHtml}</div><span class="econ-card-change ${data.direction}">${data.change}</span><div class="econ-card-footer"><span class="econ-card-prev">${data.previous}</span><a href="${data.source}" target="_blank" class="econ-card-source" onclick="event.stopPropagation()">Source: ${data.sourceText} ‚Üí</a></div></div>`;
        }

        function renderSection(title, barColor, indicatorIds) {
            const cards = indicatorIds.map(id => renderCard(id, indicatorData[id])).join('');
            return `<section class="section"><div class="section-header"><div class="section-bar" style="background: ${barColor};"></div><h2>${title}</h2></div><div class="econ-grid">${cards}</div></section>`;
        }

        function renderUSIndicators() {
            document.getElementById('us-indicators').innerHTML = renderSection('Inflation', 'var(--red)', ['us-cpi', 'us-core-cpi', 'us-pce']) + renderSection('Employment', 'var(--blue)', ['us-unemployment', 'us-nfp', 'us-jobless']) + renderSection('Growth', 'var(--green)', ['us-gdp']) + renderSection('Federal Reserve', 'var(--purple)', ['us-fed-rate']);
            updateInfoBox('us');
        }

        function renderCanadaIndicators() {
            document.getElementById('canada-indicators').innerHTML = renderSection('Inflation', 'var(--red)', ['ca-cpi', 'ca-core-cpi']) + renderSection('Employment', 'var(--blue)', ['ca-unemployment', 'ca-employment']) + renderSection('Growth & Housing', 'var(--green)', ['ca-gdp', 'ca-home-price']) + renderSection('Bank of Canada', 'var(--purple)', ['ca-boc-rate']);
            updateInfoBox('canada');
        }

        function renderQuebecIndicators() {
            document.getElementById('quebec-indicators').innerHTML = renderSection('Employment', 'var(--blue)', ['qc-unemployment', 'qc-employment']) + renderSection('Inflation & Housing', 'var(--red)', ['qc-cpi', 'qc-montreal-home', 'qc-rent']) + renderSection('Growth', 'var(--green)', ['qc-gdp']);
            updateInfoBox('quebec');
        }

        function updateInfoBox(region) {
            const box = document.getElementById(`${region}-info-box`);
            if (editMode) {
                box.className = 'info-box edit-mode';
                box.innerHTML = '‚úèÔ∏è <strong>Edit Mode Active</strong> ‚Äî Click any card to update its values.';
            } else {
                box.className = 'info-box';
                box.innerHTML = '‚ÑπÔ∏è Click üîî to see pending updates, or enable ‚úèÔ∏è Edit Mode to update values.';
            }
        }

        function renderAll() {
            renderUSIndicators();
            renderCanadaIndicators();
            renderQuebecIndicators();
            updateNotifications();
            updateTabBadges();
        }

        function checkIfStale(nextRelease) {
            if (!nextRelease) return false;
            const releaseDate = new Date(nextRelease);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            releaseDate.setHours(0, 0, 0, 0);
            return releaseDate <= today;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '';
            return new Date(dateStr).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function getStaleByCategory(category) {
            return Object.entries(indicatorData).filter(([id, data]) => data.category === category && checkIfStale(data.nextRelease)).map(([id, data]) => ({ id, ...data }));
        }

        function getAllStale() {
            return Object.entries(indicatorData).filter(([id, data]) => checkIfStale(data.nextRelease)).map(([id, data]) => ({ id, ...data })).sort((a, b) => new Date(a.nextRelease) - new Date(b.nextRelease));
        }

        function updateNotifications() {
            const stale = getAllStale();
            const badge = document.getElementById('notificationBadge');
            const list = document.getElementById('notificationList');
            badge.textContent = stale.length;
            badge.classList.toggle('hidden', stale.length === 0);
            
            if (stale.length === 0) {
                list.innerHTML = '<div class="no-notifications"><span>‚úÖ</span>All data is up to date!</div>';
            } else {
                const regionLabels = { us: 'üá∫üá∏ US', canada: 'üá®üá¶ Canada', quebec: '‚öúÔ∏è Quebec' };
                list.innerHTML = stale.map(item => `<div class="notification-item" onclick="openEditModal('${item.id}'); toggleNotifications();"><div class="notification-item-header"><span class="notification-item-title">${item.title}</span><span class="notification-item-region">${regionLabels[item.category]}</span></div><div class="notification-item-detail">Current: ${item.value} ${item.unit}</div><div class="notification-item-date">üìÖ Release was: ${formatDate(item.nextRelease)}</div></div>`).join('');
            }
        }

        function updateTabBadges() {
            ['us', 'canada', 'quebec'].forEach(region => {
                const count = getStaleByCategory(region).length;
                const tab = document.getElementById(`tab-${region}`);
                const existingBadge = tab.querySelector('.tab-badge');
                if (count > 0) {
                    if (existingBadge) { existingBadge.textContent = count; }
                    else { const badge = document.createElement('span'); badge.className = 'tab-badge'; badge.textContent = count; tab.appendChild(badge); }
                } else if (existingBadge) { existingBadge.remove(); }
            });
        }

        function toggleNotifications() { document.getElementById('notificationPanel').classList.toggle('active'); }

        function toggleEditMode() {
            editMode = !editMode;
            document.getElementById('editToggle').classList.toggle('active', editMode);
            renderAll();
        }

        function openEditModal(id) {
            if (!editMode) { editMode = true; document.getElementById('editToggle').classList.add('active'); }
            const data = indicatorData[id];
            document.getElementById('editId').value = id;
            document.getElementById('modalTitle').textContent = data.title;
            document.getElementById('modalSubtitle').textContent = `${data.period} ‚Ä¢ ${data.sourceText}`;
            document.getElementById('modalSourceLink').href = data.source;
            document.getElementById('editValue').value = data.value;
            document.getElementById('editChange').value = data.change;
            document.getElementById('editDirection').value = data.direction;
            document.getElementById('editPeriod').value = data.period;
            document.getElementById('editPrevious').value = data.previous;
            document.getElementById('editNextRelease').value = data.nextRelease || '';
            document.getElementById('editInterpretation').value = data.interpretation || '';
            document.getElementById('editModal').classList.add('active');
            document.getElementById('editValue').focus();
        }

        function closeModal() { document.getElementById('editModal').classList.remove('active'); }

        function saveEdit(event) {
            event.preventDefault();
            const id = document.getElementById('editId').value;
            const data = indicatorData[id];
            data.value = document.getElementById('editValue').value;
            data.change = document.getElementById('editChange').value;
            data.direction = document.getElementById('editDirection').value;
            data.period = document.getElementById('editPeriod').value;
            data.previous = document.getElementById('editPrevious').value;
            data.nextRelease = document.getElementById('editNextRelease').value;
            data.interpretation = document.getElementById('editInterpretation').value;
            localStorage.setItem('dashboardIndicators', JSON.stringify(indicatorData));
            closeModal();
            renderAll();
            showToast('‚úì Saved! Data stored in your browser.');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        document.addEventListener('DOMContentLoaded', () => { renderAll(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeModal(); document.getElementById('notificationPanel').classList.remove('active'); } });
        document.addEventListener('click', (e) => { const panel = document.getElementById('notificationPanel'); const bell = document.querySelector('.notification-bell'); if (panel.classList.contains('active') && !panel.contains(e.target) && !bell.contains(e.target)) { panel.classList.remove('active'); } });
    </script>
</body>
</html>
